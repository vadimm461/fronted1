<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä —Ä–∞—Å—Å—Ä–æ—á–∫–∏</title>
<style>
*{box-sizing:border-box;}
body{font-family: Arial, sans-serif;background:#f5f6f8;margin:0;padding:20px;overflow-x:hidden;}
/* ---------- –®–ê–ü–ö–ê ---------- */
.header{background:white;padding:15px;border-radius:6px;box-shadow:0 2px 6px rgba(0,0,0,.1);margin-bottom:20px;text-align:center;}
.logo{font-size:28px;font-weight:bold;letter-spacing:1px;}
.logo .green{color:#2e7d32;}
.logo .black{color:#000;}
.manager-panel{margin-top:8px;font-size:14px;color:#555;border-top:1px solid #eee;padding-top:8px;}
/* ---------- –ö–ê–õ–¨–ö–£–õ–Ø–¢–û–†–´ ---------- */
.wrapper{display:flex;gap:20px;flex-wrap:wrap;width:100%;}
.calculator{background:#fff;border-radius:6px;padding:20px;box-shadow:0 2px 6px rgba(0,0,0,0.1);flex:1 1 300px;width:100%;}
.title{font-size:20px;font-weight:bold;}
.subtitle{color:#d32f2f;font-weight:bold;margin-bottom:15px;}
.hint{margin-bottom:10px;color:#555;}
.input{width:100%;padding:10px;font-size:16px;margin-bottom:15px;border:1px solid #ccc;border-radius:4px;}
.btn{width:100%;color:white;padding:12px;font-size:16px;border:none;border-radius:4px;cursor:pointer;margin-bottom:20px;transition:.2s;}
.btn:hover{opacity:.9;}
.btn:active{transform:scale(.98);}

/* ---------- LOGIN ---------- */
.login-screen{position:fixed;top:0;left:0;width:100%;height:100vh;background:linear-gradient(135deg,#1b5e20,#000);display:flex;justify-content:center;align-items:center;padding:20px;z-index:9999;}
.login-box{background:white;padding:30px 25px;border-radius:14px;width:100%;max-width:400px;text-align:center;box-shadow:0 20px 50px rgba(0,0,0,.4);animation:fadeIn .4s ease;}
.login-logo{font-size:30px;font-weight:bold;margin-bottom:10px;}
.login-subtitle{color:#555;margin-bottom:15px;}
select,input[type="password"],#adminMessage{width:100%;padding:12px;font-size:16px;border:1px solid #ccc;border-radius:6px;margin-bottom:15px;}
.login-btn{width:100%;padding:12px;font-size:16px;border:none;border-radius:6px;cursor:pointer;color:white;background:linear-gradient(to right,#43a047,#1b5e20);}
.error-msg{color:#d32f2f;font-size:14px;margin-top:8px;}
@keyframes fadeIn{from{opacity:0;transform:translateY(10px);}to{opacity:1;transform:translateY(0);}}
/* ---------- SIDE MENU ---------- */
.menu-toggle{position:fixed;top:20px;left:20px;width:45px;height:45px;background:linear-gradient(135deg,#2e7d32,#1b5e20);color:white;display:flex;align-items:center;justify-content:center;border-radius:12px;cursor:pointer;z-index:3000;box-shadow:0 6px 20px rgba(0,0,0,.3);transition:.3s;}
.menu-toggle:hover{transform:scale(1.1);}
.side-menu{position:fixed;top:0;left:-320px;width:300px;height:100%;background:rgba(20,20,20,.95);backdrop-filter:blur(12px);color:white;padding:80px 20px 20px 20px;transition:.4s cubic-bezier(.77,0,.18,1);z-index:2500;box-shadow:10px 0 40px rgba(0,0,0,.5);}
.side-menu.active{left:0;}
.user-name{font-size:20px;font-weight:bold;margin-bottom:15px;color:#43a047;}
.session-time{margin-bottom:15px;padding:6px 12px;background:rgba(255,255,255,0.08);border-radius:8px;font-size:12px;color:#ccc;text-align:center;opacity:0.7;transition:opacity .3s;}
.session-time:hover{opacity:1;}
#workingDayTimer{margin-bottom:25px;padding:15px;background:linear-gradient(135deg,#2e7d32,#1b5e20);border-radius:12px;font-size:18px;font-weight:bold;text-align:center;color:white;box-shadow:0 0 15px rgba(46,125,50,0.7);animation:pulse 2s infinite;}
@keyframes pulse{0%{box-shadow:0 0 15px rgba(46,125,50,0.5);}50%{box-shadow:0 0 25px rgba(46,125,50,0.9);}100%{box-shadow:0 0 15px rgba(46,125,50,0.5);}}
.menu-btn{width:100%;padding:12px;margin-bottom:12px;border:none;border-radius:8px;cursor:pointer;color:white;font-size:14px;transition:.3s;background:linear-gradient(to right,#333,#222);}
.menu-btn:hover{transform:translateX(6px);background:linear-gradient(to right,#43a047,#1b5e20);}
.logout-btn{background:linear-gradient(to right,#c62828,#8e0000);}

/* ===== –ß–ê–¢-–û–ö–ù–û ===== */
#chatWindow{position:fixed;bottom:20px;right:20px;width:300px;height:400px;background:rgba(0,0,0,0.9);border-radius:12px;box-shadow:0 10px 30px rgba(0,0,0,0.5);display:flex;flex-direction:column;overflow:hidden;z-index:5000;}
#chatHeader{background:linear-gradient(135deg,#2e7d32,#1b5e20);padding:12px;color:white;font-weight:bold;cursor:pointer;display:flex;justify-content:space-between;align-items:center;}
#chatClose{cursor:pointer;font-weight:bold;}
#chatMessages{flex:1;padding:10px;overflow-y:auto;color:white;font-size:14px;background:rgba(0,0,0,0.7);}
#chatInputArea{display:flex;padding:10px;background:rgba(0,0,0,0.8);}
#chatInput{flex:1;padding:8px;border-radius:6px;border:none;font-size:14px;}
#chatSend{margin-left:6px;padding:8px 12px;border:none;border-radius:6px;background:linear-gradient(135deg,#43a047,#1b5e20);color:white;cursor:pointer;}
</style>
</head>
<body>

<!-- LOGIN SCREEN -->
<div id="loginScreen" class="login-screen">
  <div class="login-box">
    <div class="login-logo"><span class="green">A</span><span class="black">uto-</span><span class="green">S</span><span class="black">tyle</span></div>
    <div class="login-subtitle">–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</div>
    <select id="userSelect">
      <option value="cashier">–ö–∞—Å—Å–∏—Ä</option>
      <option value="evgeniy">–ï–≤–≥–µ–Ω–∏–π</option>
      <option value="vadim">–í–∞–¥–∏–º (–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä)</option>
    </select>
    <input type="password" id="passwordInput" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å">
    <button id="loginBtn" class="login-btn">–í–û–ô–¢–ò</button>
    <div id="errorMsg" class="error-msg"></div>
  </div>
</div>

<!-- SIDE MENU -->
<div class="menu-toggle" onclick="toggleMenu()">‚ò∞</div>
<div id="sideMenu" class="side-menu">
  <div class="user-name" id="currentUser"></div>
  <div class="session-time">–°–µ—Å—Å–∏—è –∏—Å—Ç–µ–∫–∞–µ—Ç —á–µ—Ä–µ–∑: <div id="timeLeft"></div></div>
  <div id="workingDayTimer" style="display:none;">–û—Å—Ç–∞–ª–æ—Å—å –≤—Ä–µ–º–µ–Ω–∏ –¥–æ –∫–æ–Ω—Ü–∞ —Ä–∞–±–æ—á–µ–≥–æ –¥–Ω—è: <div id="timeToEndOfDay"></div></div>
  <div id="notificationArea">
    <button class="menu-btn notification" id="notifBtn" onclick="readNotification()">–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
      <span class="badge" id="notifBadge">1</span>
    </button>
    <div id="notifText" style="margin-bottom:15px;display:none;background:#333;padding:10px;border-radius:6px;color:white;"></div>
  </div>
  <div id="adminNotification" style="display:none;">
    <input type="text" id="adminMessage" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è">
    <select id="receiverSelect">
      <option value="cashier">–ö–∞—Å—Å–∏—Ä—É</option>
      <option value="evgeniy">–ï–≤–≥–µ–Ω–∏—é</option>
    </select>
    <button class="menu-btn" onclick="sendNotification()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ</button>
  </div>
  <button class="menu-btn" onclick="location.href='beznal.html'">–û–§–û–†–ú–ò–¢–¨ –ë–ï–ó–ù–ê–õ</button>
  <button class="menu-btn" onclick="location.href='smena.html'">–ó–ê–ö–†–´–¢–ò–ï –°–ú–ï–ù–´</button>
  <button class="menu-btn" onclick="location.href='discount.html'">–°–ö–ò–î–û–ß–ù–ê–Ø –ö–ê–†–¢–ê</button>
  <button class="menu-btn" onclick="location.href='pass.html'">–ü–ê–†–û–õ–ò</button>
  <button class="menu-btn logout-btn" onclick="logout()">–í–´–ô–¢–ò</button>
</div>

<!-- HEADER -->
<div class="header">
  <div class="logo"><span class="green">A</span><span class="black">uto-</span><span class="green">S</span><span class="black">tyle</span></div>
  <div class="manager-panel">–ü–∞–Ω–µ–ª—å –º–µ–Ω–µ–¥–∂–µ—Ä–∞</div>
</div>

<!-- CALCULATORS -->
<div class="wrapper">
  <!-- –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä—ã –æ—Å—Ç–∞–≤–ª–µ–Ω—ã –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π, –≤—Å—Ç–∞–≤—å—Ç–µ —Å–≤–æ–π HTML –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–æ–≤ —Å—é–¥–∞ -->
</div>

<!-- BOTTOM BUTTONS -->
<div class="bottom-buttons">
  <button id="btnBeznal" class="btn btn-non-cash">–û–§–û–†–ú–ò–¢–¨ –ë–ï–ó–ù–ê–õ</button>
  <button id="btnSmena" class="btn btn-close-shift">–ó–ê–ö–†–´–¢–ò–ï –°–ú–ï–ù–´</button>
  <button id="btnDiscount" class="btn btn-discount">–†–ï–ì–ò–°–¢–†–ê–¶–ò–Ø –°–ö–ò–î–û–ß–ù–û–ô –ö–ê–†–¢–´</button>
</div>

<!-- ===== –ß–ê–¢-–û–ö–ù–û ===== -->
<div id="chatWindow">
  <div id="chatHeader">
    –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
    <span id="chatClose">‚úï</span>
  </div>
  <div id="chatMessages"></div>
  <div id="chatInputArea">
    <input type="text" id="chatInput" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ...">
    <button id="chatSend">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
  </div>
</div>

<script>
// –§—É–Ω–∫—Ü–∏–∏ —Ä–∞–±–æ—Ç—ã —Å —Å–µ—Å—Å–∏–µ–π –∏ –≤—Ö–æ–¥–æ–º
const users = {cashier: {name: "–ö–∞—Å—Å–∏—Ä", pass: "2012"}, evgeniy: {name: "–ï–≤–≥–µ–Ω–∏–π", pass: "0186"}, vadim: {name: "–í–∞–¥–∏–º", pass: "2385"}};
let currentUser = "", sessionTimer;

// –í—Ö–æ–¥ —Å –ø–∞—Ä–æ–ª–µ–º
document.getElementById("loginBtn").onclick = function () {
  const userKey = document.getElementById("userSelect").value;
  const pass = document.getElementById("passwordInput").value;
  if (pass === users[userKey].pass) {
    const expire = Date.now() + 24 * 60 * 60 * 1000; // 1 –¥–µ–Ω—å
    localStorage.setItem("session", JSON.stringify({user: userKey, expire}));
    startSession(userKey, expire);
  } else {
    document.getElementById("errorMsg").textContent = "–ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å";
  }
};

// –ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –ø—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –∞–∫—Ç–∏–≤–Ω–∞—è —Å–µ—Å—Å–∏—è
window.addEventListener("load", () => {
  const saved = localStorage.getItem("session");
  if (saved) {
    const data = JSON.parse(saved);
    if (Date.now() < data.expire) {
      startSession(data.user, data.expire);
    }
  }
});

// –ù–∞—á–∞–ª–æ —Å–µ—Å—Å–∏–∏
function startSession(userKey, expire) {
  currentUser = userKey;
  document.getElementById("loginScreen").style.display = "none";
  document.getElementById("currentUser").textContent = "üë§ " + users[userKey].name;
  updateTimer(expire);
  sessionTimer = setInterval(() => updateTimer(expire), 1000);
  if (userKey === "vadim") document.getElementById("adminNotification").style.display = "block";
  if (userKey === "cashier") document.getElementById("workingDayTimer").style.display = "block";
  setInterval(updateWorkingDay, 1000);
  loadChat();
}

function updateTimer(expire) {
  const diff = expire - Date.now();
  if (diff <= 0) logout();
  const h = Math.floor(diff / 1000 / 60 / 60);
  const m = Math.floor((diff / 1000 / 60) % 60);
  const s = Math.floor((diff / 1000) % 60);
  document.getElementById("timeLeft").textContent = `${h}—á ${m}–º ${s}—Å`;
}

function logout() {
  localStorage.removeItem("session");
  clearInterval(sessionTimer);
  location.reload();
}

// –ß–∞—Ç
const chatWindow = document.getElementById("chatWindow");
const chatHeader = document.getElementById("chatHeader");
const chatClose = document.getElementById("chatClose");
const chatMessages = document.getElementById("chatMessages");
const chatInput = document.getElementById("chatInput");
const chatSend = document.getElementById("chatSend");
let chatVisible = true;
const chatHistoryKey = "chatHistory";

chatClose.onclick = () => {
  chatWindow.style.display = "none";
  chatVisible = false;
};

chatHeader.onclick = () => {
  chatWindow.style.display = "flex";
  chatVisible = true;
  chatMessages.scrollTop = chatMessages.scrollHeight;
};

chatSend.onclick = () => {
  const text = chatInput.value.trim();
  if (!text) return;
  if (currentUser !== "vadim") return alert("–¢–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –º–æ–∂–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è");
  addMessageToDOM(users[currentUser].name, text);
  saveMessage(users[currentUser].name, text);
  chatInput.value = "";
};

function loadChat() {
  const chatHistory = localStorage.getItem(chatHistoryKey);
  if (chatHistory) {
    const messages = JSON.parse(chatHistory);
    messages.forEach(msg => addMessageToDOM(msg.user, msg.text));
  }
}

function saveMessage(user, text) {
  const messages = JSON.parse(localStorage.getItem(chatHistoryKey) || "[]");
  messages.push({user, text});
  localStorage.setItem(chatHistoryKey, JSON.stringify(messages));
}

function addMessageToDOM(user, text) {
  const messageDiv = document.createElement("div");
  messageDiv.textContent = `${user}: ${text}`;
  chatMessages.appendChild(messageDiv);
  chatMessages.scrollTop = chatMessages.scrollHeight;
}

// –û—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
function sendNotification() {
  const msg = document.getElementById('adminMessage').value.trim();
  if (!msg) return alert("–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è");
  const receiver = document.getElementById('receiverSelect').value;
  localStorage.setItem(receiver + "_notif", msg);
  document.getElementById('adminMessage').value = "";
  loadChat();
  alert("–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ!");
}

function readNotification() {
  const notifKey = currentUser + "_notif";
  const msg = localStorage.getItem(notifKey);
  if (msg) {
    document.getElementById('notifText').style.display = 'block';
    document.getElementById('notifBadge').style.display = 'none';
    localStorage.removeItem(notifKey);
  } else alert("–ù–µ—Ç –Ω–æ–≤—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π");
}

</script>
</body>
</html>
